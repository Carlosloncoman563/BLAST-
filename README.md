# BLAST-
Pipeline automatizado de VIRIONLAB para ejecutar BLAST (local o remoto), filtrar resultados por ≥97 % de identidad y ≥80 % de cobertura, descargar secuencias FASTA desde NCBI y, opcionalmente, anotar solapamientos con un archivo GFF3. Incluye instalación automática de Biopython y generación de carpeta de salida en el Escritorio.
Este script implementa un pipeline robusto denominado “VIRIONLAB — BLAST primero, GFF3 después (≥97% identidad)” para buscar homologías de secuencias y, opcionalmente, anotar los alineamientos significativos contra características codificantes (CDS) definidas en un archivo GFF3. Está pensado para uso práctico en laboratorio (diagnóstico/investigación) y prioriza la reproducibilidad, la tolerancia a errores y la portabilidad.
Al iniciar, muestra un banner informativo, registra un log de todas las acciones y valida la disponibilidad de Biopython. Si no está instalado o si el entorno es “externally managed” (PEP 668), el script crea automáticamente un entorno virtual en ~/venvs/virionlab_auto, instala Biopython y re-ejecuta el propio script dentro de ese entorno, evitando interrupciones. Adicionalmente, detecta la presencia de BLAST+ (blastn/blastp) y, si falta, intenta instalarlo con los gestores disponibles (apt/dnf/yum, Homebrew, choco o conda/mamba), sin bloquear la ejecución si no se logra.
El usuario proporciona un FASTA de entrada. El script detecta el tipo de secuencia (nucleótido/proteína), permite usar BLAST remoto (NCBI qblast) o local (si hay base creada con makeblastdb), y aplica parámetros por defecto razonables (e.g., e-value 1e-20, megablast para nucleótidos). Los resultados brutos se capturan en formato tabular tipo outfmt 6 (o se parsean desde XML en modo remoto) con campos clave (qseqid, sacc, stitle, pident, qcovhsp, coordenadas, etc.). El script normaliza accesiones (sacc) para uso consistente con Entrez (efetch), filtra por identidad mínima (≥ 97 %) y cobertura de la query (≥ 80 %, ambos configurables), y genera salidas claras:
blast_all.tsv (todos los HSPs),
blast_filtered.tsv (solo hits que cumplen umbrales),
hits_>=97pc.fasta (descargado por Entrez a partir de accesiones únicas),
blast.xml (si se usó qblast),
annotations_from_gff3.tsv (opcional).
Si el usuario lo desea, el script carga un GFF3 y calcula solapamientos HSP↔CDS por seqid y coordenadas, añadiendo columnas con strand, phase y attrs. Todos los artefactos se guardan en una carpeta auto-creada en el Escritorio: resultados BLAST_<basename>_virionlab. Al finalizar, imprime un resumen interpretativo (conteos totales vs. filtrados, criterios aplicados, notas sobre qcovhsp) y deja un log con los comandos ejecutados, facilitando auditoría, trazabilidad y repetición del análisis.
